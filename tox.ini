[tox]
envlist = py27, py33, py34
[testenv]
whitelist_externals = cp
install_command = pip install {opts} --upgrade {packages}
changedir = {envsitepackagesdir}
setenv =
	PYTHONPATH = {envsitepackagesdir}
deps =
	pytest
	pytest-xdist
	pytest-cov
	mock
commands =
	cp "{toxinidir}/.coveragerc" "{envsitepackagesdir}"
	py.test {posargs:-n 4 --cov pkgcore pkgcore/test}

[testenv:lint]
whitelist_externals =
	bash
	cp
install_command = pip install {opts} --upgrade {packages}
changedir = {envsitepackagesdir}
setenv =
	PYTHONPATH = {envsitepackagesdir}
deps = pylint
commands =
	cp -r "{toxinidir}"/lintplugin ./
	cp "{toxinidir}"/pylint ./snakeoil-pylint
	bash -c "[[ $({envpython} -c 'import sys; print(sys.version[0])') == "3" ]] && 2to3 -wn lintplugin"
	./snakeoil-pylint -f colorized --reports y snakeoil

# stub for travis-ci python nightlies tests
[testenv:pynightly]
